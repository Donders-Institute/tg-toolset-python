#!/bin/bash
export SHELL=/bin/bash

if [ "$PBS_QUEUE" == "interactive" -o "$PBS_QUEUE" == "vgl" ]
then
   export thispid="$$"
   export thispgid=$( /bin/ps -p $thispid -o pid,pgid | grep -v grep | grep $thispid | awk -F" " '{ print $2 }' )
   if ! ${DISPLAY+"false"} # true if DISPLAY is set
   then
      /opt/cluster/bin/cluster-yadjobinfo $thispgid
   fi
   /bin/bash -l
else
   /bin/bash -l
fi

########################################
# Use below example in case of testing #
########################################
#if [ "$USER" == "edwger" -o "$USER" == "honlee" -o "$USER" == "maamen" -o "$USER" == "roboos" -o "$USER" == "marzwi" ]
#then
#   #echo $USER
#   export thispid="$$"
#   # thispid is only used to determine the processGroupID: thispgid below
#   #export thispgid=$( ps -p $thispid -o pgid | grep "$thispid" )
#   export thispgid=$( /bin/ps -p $thispid -o pid,pgid | grep -v grep | grep $thispid | awk -F" " '{ print $2 }' )
#
#   #echo thispid=$thispid
#   #echo thispgid=$thispgid
#   if [ "$PBS_QUEUE" == "interactive" -o "$PBS_QUEUE" == "vgl" ]
#   then
#      if ! ${DISPLAY+"false"} # true if DISPLAY is set
#      then
#         #if [ "$USER" == "edwger" ]
#         #then
#         #   /home/tg/edwger/test/cluster-yadjobinfo $thispgid
#         #else
##            /opt/cluster/bin/cluster-yadjobinfo $thispgid
#         #fi
#      fi
#   fi
#   /bin/bash -l
#else
#   /bin/bash -l
###fi
